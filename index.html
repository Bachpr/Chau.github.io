<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thi·ªáp Ch√∫c M·ª´ng 20/10 - Uy√™n Ch√¢u Cute</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=Quicksand:wght@400;600;700&family=Allura&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg1: #fff0f5;
      --bg2: #ffdbe6;
      --bg3: #fff0f5;
      --text: #57104f;
      --panel: rgba(255,255,255,0.88);
      --panel-border: #fbcfe8;
      --accent: #ec4899;
      --accent-strong: #db2777;
      --body-glow: 0 0 8px rgba(236,72,153,0.35);
      --title-grad: linear-gradient(90deg,#9d174d,#ec4899,#7c3aed,#9d174d);
      --title-shadow: 0 0 8px rgba(236,72,153,.25);
    }
    [data-theme="dark"]{
      --bg1: #1a161c;
      --bg2: #251b27;
      --bg3: #1a161c;
      --text: #fde2e2;
      --panel: rgba(60,40,60,0.72);
      --panel-border: #f5a8c8;
      --accent: #f472b6;
      --accent-strong: #be185d;
      --body-glow: 0 0 10px rgba(255,192,203,.55);
      --title-grad: linear-gradient(90deg,#fecdd3,#f472b6,#a78bfa,#fecdd3);
      --title-shadow: 0 0 10px rgba(255,192,203,.30);
    }
    html,body{height:100%}
    body{
      margin:0; font-family: Quicksand, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      color:var(--text);
      background: linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 50%, var(--bg3) 100%);
      background-attachment: fixed;
      display:flex; align-items:center; justify-content:center; min-height:100vh; overflow:hidden;
      animation: fadeIn 1.2s ease;
    }
    @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }

    .wrap{min-height:100vh; display:grid; place-items:center; padding:24px; position:relative}

    .card{
      max-width: 900px; width: min(96vw, 900px);
      background: var(--panel);
      border: 1px solid var(--panel-border);
      border-radius: 24px; padding: 28px; backdrop-filter: blur(10px);
      box-shadow: 0 0 35px rgba(255,182,193,0.7), 0 0 80px rgba(255,192,203,0.5);
      text-align:center;
      animation: gentleGlow 5s ease-in-out infinite;
      position:relative; overflow:hidden;
    }
    @keyframes gentleGlow {
      0%,100% { box-shadow: 0 0 40px rgba(255,182,193,0.6), 0 0 90px rgba(255,192,203,0.4); transform:scale(1); }
      50% { box-shadow: 0 0 70px rgba(255,105,180,0.9), 0 0 130px rgba(255,182,193,0.8); transform:scale(1.01); }
    }

    .title{ 
      font-family: 'Playfair Display', ui-serif, Georgia, serif;
      font-size: clamp(30px, 5.6vw, 50px);
      font-weight: 800; margin: 0 0 10px;
      background-image: var(--title-grad);
      background-size: 200% 200%;
      -webkit-background-clip: text; background-clip: text; color: transparent;
      filter: drop-shadow(var(--title-shadow));
      animation: hueSlide 6s linear infinite;
    }
    @keyframes hueSlide{ 0%{background-position-x:0%} 50%{background-position-x:100%} 100%{background-position-x:0%} }
    .lead{ font-size:18px; line-height:1.75; text-shadow: var(--body-glow); margin: 10px auto 0; max-width: 64ch }
    .message { margin-top:14px; font-size:16px; line-height:1.8; color:#6b213a; text-align:justify; max-width:68ch; margin-left:auto; margin-right:auto; }
    .row{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top: 16px }
    .btn{ appearance:none; border:1px solid rgba(236,72,153,.5); background: var(--accent); color:#fff; padding:10px 14px; border-radius: 12px; cursor:pointer; font-weight: 700; box-shadow: 0 6px 18px rgba(236,72,153,.30); transition: transform .15s ease, filter .15s ease, background .2s ease }
    .btn:hover{ transform: translateY(-1px) scale(1.03); filter: brightness(1.05) }
    .btn-outline{ background: transparent; color: var(--text); border:1px solid rgba(236,72,153,.45); box-shadow: 0 4px 14px rgba(0,0,0,.06) }
    .btn-outline:hover{ background: rgba(236,72,153,.18) }
    .btn-ghost{ background: transparent; color: var(--accent-strong); border: 1px dashed rgba(236,72,153,.5) }
    .btn-ghost:hover{ background: rgba(236,72,153,.15) }

    .signature{font-family:'Allura',cursive;font-size:28px;color:var(--accent-strong);margin-top:20px;display:inline-block;white-space:nowrap;overflow:hidden;border-right:2px solid var(--accent-strong);opacity:0;animation:typing 3s steps(30,end) forwards,blink 1s step-end infinite alternate,glowPulse 3s ease-in-out infinite}
    @keyframes typing{0%{width:0;opacity:1}100%{width:100%;opacity:1}}
    @keyframes blink{50%{border-color:transparent}}
    @keyframes glowPulse{0%,100%{text-shadow:0 0 8px rgba(255,105,180,0.6)}50%{text-shadow:0 0 18px rgba(255,105,180,0.9)}}

    .confetti{ position: fixed; inset: 0; pointer-events:none; overflow:hidden; }
    .piece{ position:absolute; top:-40px; will-change: transform, opacity; animation: fall 2.2s ease-out forwards }
    @keyframes fall{ 0%{ transform: translateY(-40px) rotate(0deg); opacity:0 } 10%{ opacity:1 } 100%{ transform: translateY(100vh) rotate(360deg); opacity:0 } }
    .audio-hint{ font-size:12px; opacity:.8; margin-top:6px }
    @keyframes pulseHeart{0%,100%{opacity:.9;transform:scale(1);}50%{opacity:1;transform:scale(1.07);}}

    canvas { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:-1; }

    .hr{height:1px;background:linear-gradient(90deg,transparent,rgba(236,72,153,.35),transparent);margin:14px 0}
    .compact{font-size:12px;opacity:.8}
  </style>
</head>
<body>
  <canvas id="fireworks"></canvas>
  <div class="wrap" id="app" data-theme="light">
    <div class="card" id="cardRoot">
      <div style="font-size:28px; margin-bottom:8px">üíó</div>
      <h1 class="title">Thi·ªáp Ch√∫c M·ª´ng 20/10</h1>
      <p class="lead">
        G·ª≠i ƒë·∫øn <strong id="receiver-name">Uy√™n Ch√¢u Cute</strong> nh·ªØng l·ªùi ch√∫c t·ªët ƒë·∫πp nh·∫•t nh√¢n ng√†y Ph·ª• N·ªØ Vi·ªát Nam 20/10.
        Ch√∫c b·∫°n lu√¥n xinh ƒë·∫πp, m·∫°nh m·∫Ω, th√†nh c√¥ng v√† h·∫°nh ph√∫c. Mong m·ªói ng√†y ƒë·ªÅu r·ª±c r·ª° nh∆∞ hoa h·ªìng h·ªìng.
      </p>
      <p style="margin-top:14px; font-size:18px; color:var(--accent); font-weight:600; animation: pulseHeart 2.5s ease-in-out infinite;">- T·∫∑ng ri√™ng cho <strong id="receiver-name-2">Uy√™n Ch√¢u Cute üíû</strong></p>

      <p class="message" id="message-content">
        C·∫£m ∆°n b·∫°n v√¨ lu√¥n l√† ng∆∞·ªùi ƒë√°ng y√™u, t·ªët b·ª•ng v√† t·ªèa s√°ng nh∆∞ √°nh m·∫∑t tr·ªùi m·ªói ng√†y. Mong r·∫±ng h√¥m nay v√† m·ªçi ng√†y sau ƒë·ªÅu tr√†n ng·∫≠p ti·∫øng c∆∞·ªùi, ni·ªÅm vui v√† h·∫°nh ph√∫c. D√π ƒëi ƒë√¢u, l√†m g√¨, h√£y lu√¥n gi·ªØ n·ª• c∆∞·ªùi r·∫°ng r·ª° v√† tr√°i tim ƒë·∫ßy y√™u th∆∞∆°ng nh√©. B·∫°n x·ª©ng ƒë√°ng nh·∫≠n ƒë∆∞·ª£c m·ªçi ƒëi·ªÅu t·ªët ƒë·∫πp nh·∫•t!
      </p>

      <div class="row">
        <button class="btn" id="btn-confetti">üéâ B·∫Øn Hoa Gi·∫•y</button>
        <button class="btn" id="startFireworks">üéÜ Ph√°o Hoa</button>
      </div>

      <div class="row">
        <button class="btn btn-outline" id="btn-toggle">üåô Ch·∫ø ƒê·ªô T·ªëi</button>
        <button class="btn btn-ghost" id="btn-music">üîä B·∫≠t Nh·∫°c</button>
        <button class="btn" id="btn-download">üì∏ T·∫£i PNG</button>
        <button class="btn" id="btn-share">üì§ Chia s·∫ª</button>
        <button class="btn btn-outline" id="btn-perf">‚ö° Hi·ªáu nƒÉng cao</button>
      </div>

      <div class="row" style="align-items:center;gap:12px">
        <span class="compact">√Çm l∆∞·ª£ng</span>
        <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.6" style="width:160px; accent-color:var(--accent);"/>
        <button class="btn btn-outline" id="btn-pause">‚è∏ T·∫°m D·ª´ng</button>
      </div>
      <div class="audio-hint compact" id="audio-hint">Ch·ªçn "B·∫≠t Nh·∫°c" ƒë·ªÉ ph√°t lo-fi d·ªãu nh·∫π ‚ô™</div>

      <div class="signature">- T·ª´ ng∆∞·ªùi g·ª≠i: HNB üíå</div>
    </div>

    <div class="confetti" id="confetti-root"></div>

    <div id="yt-holder" style="width:0;height:0;overflow:hidden;position:absolute;left:-9999px;top:-9999px;">
      <div id="yt-player"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    (function(){
      const app = document.getElementById('app');
      const cardRoot = document.getElementById('cardRoot');
      const confettiRoot = document.getElementById('confetti-root');
      const btnConfetti = document.getElementById('btn-confetti');
      const btnToggle = document.getElementById('btn-toggle');
      const btnMusic = document.getElementById('btn-music');
      const hint = document.getElementById('audio-hint');
      const vol = document.getElementById('volume-slider');
      const btnPause = document.getElementById('btn-pause');
      const btnDownload = document.getElementById('btn-download');
      const btnShare = document.getElementById('btn-share');
      const startFireworksBtn = document.getElementById('startFireworks');
      const btnPerf = document.getElementById('btn-perf');

      function isDark(){ return app.getAttribute('data-theme') === 'dark'; }
      function setDark(val){ app.setAttribute('data-theme', val ? 'dark' : 'light'); btnToggle.textContent = val ? '‚òÄÔ∏è Ch·∫ø ƒê·ªô S√°ng' : 'üåô Ch·∫ø ƒê·ªô T·ªëi'; }

      setDark(false);
      btnToggle.addEventListener('click',()=> setDark(!isDark()));

      let ytPlayer = null;
      const tag = document.createElement('script');
      tag.src = 'https://www.youtube.com/iframe_api';
      document.head.appendChild(tag);

      window.onYouTubeIframeAPIReady = function(){
        ytPlayer = new YT.Player('yt-player', {
          videoId: 'IpFX2vq8HKw',
          playerVars: { autoplay: 0, controls: 0, rel: 0, modestbranding: 1, playsinline: 1 },
          events: {
            onReady: function(){ try{ ytPlayer.setVolume(parseFloat(vol.value||'0.6')*100); }catch(_){} },
            onStateChange: function(e){
              if(e.data === YT.PlayerState.PLAYING){ btnMusic.textContent='üîá T·∫Øt Nh·∫°c'; btnPause.textContent='‚è∏ T·∫°m D·ª´ng'; hint.style.display='none'; }
              if(e.data === YT.PlayerState.PAUSED || e.data === YT.PlayerState.ENDED){ btnMusic.textContent='üîä B·∫≠t Nh·∫°c'; btnPause.textContent='‚ñ∂ Ph√°t L·∫°i'; }
            }
          }
        });
      };

      function toggleMusic(){ if(!ytPlayer) return; const st = ytPlayer.getPlayerState(); if(st !== 1){ ytPlayer.playVideo(); } else { ytPlayer.pauseVideo(); } }
      btnMusic.addEventListener('click', toggleMusic);

      function togglePause(){ if(!ytPlayer) return; const st = ytPlayer.getPlayerState(); if(st !== 1){ ytPlayer.playVideo(); } else { ytPlayer.pauseVideo(); } }
      btnPause.addEventListener('click', togglePause);

      vol.addEventListener('input', function(){ if(ytPlayer) ytPlayer.setVolume(parseFloat(this.value||'0.6')*100); });
      btnPause.textContent = '‚ñ∂ Ph√°t L·∫°i';

      function spawnConfetti(){
        const emojis = ['üíñ','üå∏','üéÄ','‚ú®','üíê','üå∑','üåπ'];
        for(let i=0;i<22;i++){
          const el = document.createElement('span');
          el.className='piece';
          el.textContent = emojis[i % emojis.length];
          el.style.left = Math.random()*100 + 'vw';
          el.style.fontSize = (12 + Math.random()*18) + 'px';
          el.style.animationDelay = (Math.random()*0.4) + 's';
          confettiRoot.appendChild(el);
          setTimeout(()=> el.remove(), 2400);
        }
      }
      btnConfetti.addEventListener('click', spawnConfetti);

      const canvas = document.getElementById('fireworks');
      const ctx = canvas.getContext('2d');
      function resizeCanvas(){
        const dpr = Math.min(window.devicePixelRatio || 1, 2);
        canvas.width = Math.floor(innerWidth * dpr);
        canvas.height = Math.floor(innerHeight * dpr);
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }
      let _rzTO;
      window.addEventListener('resize', ()=>{ clearTimeout(_rzTO); _rzTO = setTimeout(resizeCanvas, 150); });
      resizeCanvas();

      class Firework{
        constructor(x,y,color){
          this.x=x;this.y=y;this.color=color;
          this.particles=[];
          for(let i=0;i<getParticleCount();i++){
            const angle=Math.random()*2*Math.PI;
            const speed=Math.random()*8+2;
            const radius=Math.random()*3+1;
            this.particles.push({x:this.x,y:this.y,dx:Math.cos(angle)*speed,dy:Math.sin(angle)*speed,alpha:1,r:radius});
          }
        }
        update(){
          this.particles.forEach(p=>{
            p.x+=p.dx;
            p.y+=p.dy;
            p.dy+=0.05;
            p.alpha-=0.012;
          });
          this.particles=this.particles.filter(p=>p.alpha>0);
        }
        draw(){
          this.particles.forEach(p=>{
            const gradient=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*3);
            gradient.addColorStop(0,this.color);
            gradient.addColorStop(1,'rgba(255,255,255,0)');
            ctx.globalAlpha=p.alpha;
            ctx.fillStyle=gradient;
            ctx.beginPath();
            ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
            ctx.fill();
          });
          ctx.globalAlpha=1;
        }
      }

      class ShootingStar{
        constructor(){ this.reset(); }
        reset(){
          this.x=Math.random()*canvas.width;
          this.y=Math.random()*canvas.height*0.3;
          this.len=Math.random()*200+100;
          this.speed=Math.random()*8+5;
          this.alpha=1;
          this.color=`hsl(${Math.random()*360},100%,80%)`;
        }
        update(){
          this.x-=this.speed;
          this.y+=this.speed/2;
          this.alpha-=0.01;
          if(this.alpha<=0) this.reset();
        }
        draw(){
          const grad=ctx.createLinearGradient(this.x,this.y,this.x+this.len,this.y-this.len/2);
          grad.addColorStop(0,'rgba(255,255,255,0)');
          grad.addColorStop(1,this.color);
          ctx.globalAlpha=this.alpha;
          ctx.strokeStyle=grad;
          ctx.lineWidth=2;
          ctx.beginPath();
          ctx.moveTo(this.x,this.y);
          ctx.lineTo(this.x+this.len,this.y-this.len/2);
          ctx.stroke();
          ctx.globalAlpha=1;
        }
      }

      function getParticleCount(){ return perfHigh ? 100 : 35; }
      let fireworks=[];
      let stars=[];
      for(let i=0;i<5;i++) stars.push(new ShootingStar());

      let targetFPS = 60; let targetFRAME = 1000 / targetFPS; let _lastTime = 0;
      function setFPS(f){ targetFPS = f; targetFRAME = 1000 / targetFPS; }
      function animate(ts){
        if(!ts) ts = performance.now();
        const delta = ts - _lastTime;
        if (delta >= targetFRAME) {
          _lastTime = ts - (delta % targetFRAME);
          ctx.fillStyle='rgba(0,0,0,0.15)';
          ctx.fillRect(0,0,canvas.width,canvas.height);
          fireworks.forEach(f=>{f.update();f.draw();});
          fireworks = fireworks.filter(f=>f.particles.length>0);
          stars.forEach(s=>{s.update();s.draw();});
        }
        requestAnimationFrame(animate);
      }
      requestAnimationFrame(animate);

      let perfHigh = true; function applyPerfLabel(){ btnPerf.textContent = perfHigh ? '‚ö° Hi·ªáu nƒÉng cao' : 'ü™´ Ti·∫øt ki·ªám pin'; }
      applyPerfLabel(); setFPS(60);
      btnPerf.addEventListener('click', ()=>{ perfHigh = !perfHigh; setFPS(perfHigh ? 60 : 30); applyPerfLabel(); });

      startFireworksBtn.addEventListener('click',()=>{
        const bursts = perfHigh ? 6 : 3;
        for(let i=0;i<bursts;i++){
          const x=Math.random()*canvas.width*0.8+canvas.width*0.1;
          const y=Math.random()*canvas.height*0.5+canvas.height*0.2;
          const color=`hsl(${Math.random()*360},100%,70%)`;
          fireworks.push(new Firework(x,y,color));
        }
        stars.forEach(s=>{s.color=`hsl(${Math.random()*360},100%,80%)`;});
      });

      async function captureCardAsBlob(){
        const canvasShot = await html2canvas(cardRoot, {backgroundColor: null, scale: 2, useCORS:true});
        return await new Promise(res=> canvasShot.toBlob(res, 'image/png'));
      }

      btnDownload.addEventListener('click', async ()=>{
        try{
          const blob = await captureCardAsBlob();
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url; a.download = 'thiep-20-10.png';
          document.body.appendChild(a); a.click(); a.remove();
          setTimeout(()=> URL.revokeObjectURL(url), 1500);
        }catch(e){ alert('Kh√¥ng th·ªÉ ch·ª•p ·∫£nh thi·ªáp.'); }
      });

      btnShare.addEventListener('click', async ()=>{
        try{
          const title = 'Thi·ªáp 20/10';
          const text = 'M√¨nh g·ª≠i b·∫°n chi·∫øc thi·ªáp nh·ªè xinh';
          if(navigator.canShare && navigator.canShare({ files: [new File([new Blob()], 'x.png', {type:'image/png'})] })){
            const blob = await captureCardAsBlob();
            const file = new File([blob], 'thiep-20-10.png', { type:'image/png' });
            await navigator.share({ files:[file], title, text });
          } else if(navigator.share){
            await navigator.share({ title, text, url: location.href });
          } else {
            document.getElementById('btn-download').click();
          }
        }catch(e){ }
      });

    })();
  </script>
</body>
</html>
